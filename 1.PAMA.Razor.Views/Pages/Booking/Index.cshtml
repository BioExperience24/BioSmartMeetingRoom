@page "/booking"
@model _1.PAMA.Razor.Views.Pages.Booking.IndexModel
@{
    Layout = "_LayoutAdmin";
    ViewData["PageName"] = "Booking";
}

@section Styles
{
    <link href="~/assets/theme/plugins/jquery-datatable/skin/bootstrap/css/dataTables.bootstrap.css" rel="stylesheet">
    <link href="~/assets/theme/plugins/jquery-datatable/select.dataTables.min.css" rel="stylesheet">
    <link href="~/assets/theme/plugins/jquery-datatable/fixedColumns.dataTables.min.css" rel="stylesheet">
    <link href="~/assets/external/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet" />
    <link href="~/assets/external/daterangepicker/daterangepicker.css" rel="stylesheet" />
    <link href="~/assets/external/jquery-timepicker/jquery.timepicker.min.css" rel="stylesheet" />
    <link href="~/assets/external/tippy-theme-light.min.css" rel="stylesheet" />
    <style>
        .form-group-filter{

            border-radius: 5px;
            transition: 0.3s;
            border: 1px solid #d5cfe0;
            padding: 5px;
            display: table;
            table-layout: fixed;
            width: 100%;
            min-height: 45px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .form-group-filter-flex{
            display: flex;
        }
        .form-group-filter-icon{
            padding-left: 5px;
            display: table-cell;
            vertical-align: middle;
            width: 14%;
        }
        .form-group-filter-form{
            display: table-cell;
            vertical-align: middle;
        }
        .form-group-filter-form>.form-control{
            border: 0px solid #ccc !important;
        }

        
        .btn-noshadow{
            background: #fff;
            box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.16), 0 0px 0px rgba(0, 0, 0, 0.0) !important;
    
        }
        .formpantry-witdh{
            width: 100px;
        }

        .media:hover{
            /* background-color: #f4ecec;*/
            border: 2px solid #bf104b !important;
            cursor: pointer;
        }
        .media{
            padding: 5px;
            border-radius: 5px;
            transition: 0.3s;
            border: 2px solid transparent;

        }
        .media, .media-body{
            overflow: visible;
        }
        .label-bordered {
            border: 1px solid #333 !important;
            color : #333 !important;
            border-radius: 4px;
        }
        .selectedRoom{
            border:2px solid blue;
        }
        .btn.active{
            background: #bf104b !important;
        }
        .img-booking{
            width: 100%;
            height: 200px;
        }
        .img-booking2{
            width: 100%;
            height: 250px;
        }
        .caption{
            padding:5px !important; 
        }
        td.day.disabled {
            color: white !important;
            background: #B2DFDB !important;
        }
        .timedisabled {
            font-weight: bold !important;
            /* color: #fff !important;
            background: #bc0000 !important;
            text-transform: uppercase;*/
            color: white !important;
            background: #B2DFDB !important;
        }

        .select tbody tr.disabled {
            color: white !important;
            background: #B2DFDB !important;
        }
        .input-group{
            margin-bottom : 0px !important;
        }
        .lbl_text{
            font-size: 14px;
        }
        .lbl_text_location{
            font-size: 12px;
        }
        .popover{
            max-width: 500px;
            
        }
        hr {
            margin: none;
            border: none;
            height: 2px;
            background-image: -webkit-linear-gradient(left, rgba(255,2,5,.5), rgba(137,11,138,.5), rgba(27,123,187,.5), rgba(47,195,44,.5), rgba(253,201,1,.5), rgba(255,91,2,.5), #ccc 15%, #ccc 85%, rgba(255,91,2,.5), rgba(253,201,1,.5), rgba(47,195,44,.5), rgba(27,123,187,.5), rgba(137,11,138,.5), rgba(255,2,5,.5));
                background-image: -moz-linear-gradient(left, rgba(255,2,5,.5), rgba(137,11,138,.5), rgba(27,123,187,.5), rgba(47,195,44,.5), rgba(253,201,1,.5), rgba(255,91,2,.5), #ccc 15%, #ccc 85%, rgba(255,91,2,.5), rgba(253,201,1,.5), rgba(47,195,44,.5), rgba(27,123,187,.5), rgba(137,11,138,.5), rgba(255,2,5,.5)); 
                background-image: -ms-linear-gradient(left, rgba(255,2,5,.5), rgba(137,11,138,.5), rgba(27,123,187,.5), rgba(47,195,44,.5), rgba(253,201,1,.5), rgba(255,91,2,.5), #ccc 15%, #ccc 85%, rgba(255,91,2,.5), rgba(253,201,1,.5), rgba(47,195,44,.5), rgba(27,123,187,.5), rgba(137,11,138,.5), rgba(255,2,5,.5));
                background-image: -o-linear-gradient(left, rgba(255,2,5,.5), rgba(137,11,138,.5), rgba(27,123,187,.5), rgba(47,195,44,.5), rgba(253,201,1,.5), rgba(255,91,2,.5), #ccc 15%, #ccc 85%, rgba(255,91,2,.5), rgba(253,201,1,.5), rgba(47,195,44,.5), rgba(27,123,187,.5), rgba(137,11,138,.5), rgba(255,2,5,.5));
            } 
        .lbl_text_cost{
            font-size: 22px;
            font-style: italic;
        }
        @@media screen and (min-width: 480px) {
            .img-booking{
                height: 200px;
            }
            .formpantry-witdh{
                width: 40px;
            }
        }
        @@media screen and (min-width: 240px) {
            .img-booking{
                height: 180px;
            }
            .formpantry-witdh{
                width: 40px;
            }
        }

        .modal-dialog {
            position:absolute;
            top:50% !important;
            transform: translate(0, -50%) !important;
            -ms-transform: translate(0, -50%) !important;
            -webkit-transform: translate(0, -50%) !important;
            margin:auto 5%;
            width:90%;
            height:80%;
        }
        .modal-content {
            min-height:100%;
            position:absolute;
            top:0;
            bottom:0;
            left:0;
            right:0; 
        }
        .modal-body {
            position:absolute;
            top:45px; /** height of header **/
            bottom:45px;  /** height of footer **/
            left:0;
            right:0;
            overflow-y:auto;
        }
        .modal-footer {
            position:absolute;
            bottom:0;
            left:0;
            right:0;
        }

        .ui-timepicker-container{ 
            z-index:999 !important; 
        }

        /* Chrome, Safari, Edge, Opera */
        input.number-without-arrow::-webkit-outer-spin-button,
        input.number-without-arrow::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
        }

        /* Firefox */
        input.number-without-arrow[type=number] {
        -moz-appearance: textfield;
        }

        #div_crt_timestart > .input-group > .bootstrap-select > .dropdown-menu,
        #div_crt_timeend > .input-group > .bootstrap-select > .dropdown-menu
        {
            overflow: hidden !important;
            max-height: 250px !important;
        }

        #div_crt_timestart > .input-group > .bootstrap-select > .dropdown-menu > ul,
        #div_crt_timeend > .input-group > .bootstrap-select > .dropdown-menu > ul
        {
            max-height: 250px !important;
        }

        #div_crt_timestart > .input-group > .bootstrap-select > .dropdown-toggle > .bs-caret,
        #div_crt_timeend > .input-group > .bootstrap-select > .dropdown-toggle > .bs-caret
        {
            display:none !important;
        }
    </style>
}

<section class="content">
    <div class="container-fluid">
        <div class="block-header">
            <h2>
                @ViewData["PageName"]
            </h2>
        </div>
        <div class="row clearfix">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="nav nav-tabs tab-nav-right" role="tablist">
                    <li role="presentation" ><a href="#homepage" data-toggle="tab"><b>Booking List</b></a></li>
                    <li role="presentation" class="active"><a href="#booknowpage" data-toggle="tab" data-room-category="room"><b>Book Now</b></a></li>
                    <li role="presentation"><a href="#booknowpage" data-toggle="tab" data-room-category="trainingroom"><b>Training Room</b></a></li>
                    <li role="presentation"><a href="#booknowpage" data-toggle="tab" data-room-category="noroom"><b>No Room</b></a></li>
                    @* <li role="presentation"><a href="#booknowpage" data-toggle="tab" data-room-category="specialroom"><b>Special Room</b></a></li> *@
                </ul>
            </div>
        </div>
        <div class="row clearfix">
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane fade " id="homepage">
                    <div id="id_area_booklist" class="card">
                        <div class="body">
                            <div class="row clearfix">
                                <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">date_range</i>
                                        </span>
                                        <div class="form-line">
                                            <input id="id_schedule_daterange_search" type="text" class="form-control ">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">people</i>
                                        </span>
                                        <select class="form-control" id="id_schedule_employee_search" data-live-search="true">
                                            <option value="">Load Data..</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">my_location</i>
                                        </span>
                                        <select class="form-control" id="id_schedule_building_search" data-live-search="true">
                                            <option value="">Load Data..</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">map</i>
                                        </span>
                                        <select class="form-control" id="id_schedule_room_search" data-live-search="true">
                                            <option value="">Load Data..</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2">
                                    <button class="btn btn-success waves-effect" id="id_schedule_search"><b>Filter</b></button>
                                </div>
                            </div>
                            <div class="row clearfix">
                                <div class="col-xs-12">
                                    <div class="table-responsive">
                                        <table class="table table-hover" id="tbldata" style="width: 100% !important;">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Status</th>
                                                    <th>Subject</th>
                                                    <th>Room</th>
                                                    <th >Date</th>
                                                    <th>Time</th>
                                                    <th>Attendees</th>
                                                    <th>Organizer</th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @* <tr>
                                                    <td>1</td>
                                                    <td>Weekly Meeting</td>
                                                    <td>Merger Room 1</td>
                                                    <td>09 Jan 2025</td>
                                                    <td>10:00 - 12:00</td>
                                                    <td>10</td>
                                                    <td>Dev 1</td>
                                                </tr> *@
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <!-- <div class="table-responsive responsive">
                                        
                                    </div> -->
                            </div>
                        </div>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane fade in active " id="booknowpage">
                    <div class="row clearfix" id="id_area_find_room">
                        @await Html.PartialAsync("Booking/Components/FindRoomPage")
                    </div>
                </div>
            </div>
            <div class="row clearfix hidden" id="id_area_reserve_room" style="padding: 0px 15px;">
                @await Html.PartialAsync("Booking/Components/ReserveRoomPage")
            </div>
        </div>
    </div>
</section>
<div class="modal fade" id="id_mdl_reschedule" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="idmdlcrLabel">Reschedule Meeting - <b id="id_res_text_name"></b></h4>
            </div>
            <div class="modal-body " id="id_mdl_reschedule_body">
                <form id="frm_reschedule">
                    <label for="">Date</label>
                    <div class="form-group">
                        <div class="form-line">
                            <input autocomplete="off" readonly="" required="" type="text" id="id_frm_res_date_dummy" class="form-control" placeholder="Date">
                            <input type="hidden" name="date" id="id_frm_res_date" class="form-control">
                            <input type="hidden" name="timezone" id="id_frm_res_timezone" class="form-control">
                            <input type="hidden" name="booking_id" id="id_frm_res_booking_id" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row clearfix">
                            <input type="hidden" name="start" id="id_frm_res_start_input">
                            <input type="hidden" name="end" id="id_frm_res_end_input">
                            <div class="col-xs-6 align-left">
                                <label for="">START</label>&nbsp;&nbsp;&nbsp;
                                <button data-type="start" data-id="id_frm_res_start" onclick="openAlertPilihRes($(this))" type="button" class="btn btn-default btn-sm waves-effect">
                                    @* <b id="id_frm_res_start" class="lbl_text">07:30 AM</b> <span class="caret"> &nbsp;</span> *@
                                    <b id="id_frm_res_start" class="lbl_text">--:--</b> <span class="caret"> &nbsp;</span>
                                </button>
                            </div>
                            <div class="col-xs-6 align-right">
                                <label for="">FINISH</label>&nbsp;&nbsp;&nbsp;
                                <button data-type="end" data-id="id_frm_res_finish" onclick="openAlertPilihRes($(this))" type="button" class="btn btn-default btn-sm waves-effect">
                                    @* <b id="id_frm_res_finish" class="lbl_text">07:30 AM</b> <span class="caret"> &nbsp;</span> *@
                                    <b id="id_frm_res_finish" class="lbl_text">--:--</b> <span class="caret"> &nbsp;</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <button type="submit" style="display: none;" id="id_btn_res_submit" class="btn btn-primary m-t-15 waves-effect">Submit</button>
                </form>
            </div>
            <div class="modal-footer">
                <div class="row clearfix">
                    <div class="col-xs-6 align-left">
                        <button type="button" class="btn btn-link waves-effect" data-dismiss="modal">CLOSE</button>
                    </div>
                    <div class="col-xs-6 ">
                        <button onclick="clickSubmit('id_btn_res_submit')" type="button" class="btn btn-primary waves-effect ">RESCHEDULE MEETING</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="id_mdl_partisipant" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="id_mdl_partisipantLabel">Attendees From <b id="id_partisipant_title"></b></h4>
            </div>
            <div class="modal-body " id="id_mdl_partisipant_body">
                <div class="card">
                    <div class="header">
                        <div class="row clearfix">
                            <div class="col-xs-12 col-sm-12">
                                <h2>Attendees Internal</h2>
                            </div>
                        </div>
                    </div>
                    <div class="body">
                        <br>
                        <div class="row clearfix">
                            <div class="col-xs-12 ">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="tbldataInternal">
                                        <thead>
                                            <th>#</th>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Phone</th>
                                            <th>Ext No.</th>
                                            <th>Status</th>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br>
                <div class="card">
                    <div class="header">
                        <div class="row clearfix">
                            <div class="col-xs-12 col-sm-12">
                                <h2>Attendees External</h2>
                            </div>
                        </div>
                    </div>
                    <div class="body">
                        <br>
                        <div class="row clearfix">
                            <div class="col-xs-12  ">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="tbldataEksternal">
                                        <thead>
                                            <th>#</th>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Organization/Company</th>
                                            <!-- <th >Position</th> -->
                                            <th>Status</th>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row clearfix">
                    <div class="col-xs-6 align-left">
                    </div>
                    <div class="col-xs-6 ">
                        <button type="button" class="btn btn-link waves-effect" data-dismiss="modal">CLOSE</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="id_mdl_additional_partisipant" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="id_mdl_additional_partisipantLabel">Add Attendees</h4>
            </div>
            <div class="modal-body " id="id_mdl_additional_partisipant_body">
                <form id="id_frm_additional">
                    <div class="container-fluid">
                        <div class="row clearfix">
                            <div class="col-12 col-xs-12 col-sm-6 col-md-6 col-lg-6 hidden">
                                <input type="hidden" id="id_frm_additional_booking_id">
                            </div>
                            <div class="col-12 col-xs-12 col-sm-6 col-md-6 col-lg-6">    
                                <div class="row clearfix">
                                    <div class="col-xs-12">
                                        <b class="lbl_text">INTERNAL ATTENDEES</b>
                                        <div class="input-group add-attendance-section">
                                            <select data-size="4" title="Choose the attendees..." data-actions-box="true" data-selected-text-format="count > 0" multiple id="id_frm_additional_participant" class="form-control show-tick" data-live-search="true">
                                            </select>
                                            <span class="input-group-addon">
                                                <button onclick="clickPartisipantAdditional($(this))" type="button" class="btn bg-blue waves-effect">
                                                    <i class="material-icons">add</i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                    <div style="height: 50vh;overflow-y: scroll;;background: #fff;" class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                        <table class="table table-bordered" style="border-collapse: collapse;border-spacing: 0;" id="id_list_tbl_additional_participant">
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                <div class="row clearfix">
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                        <b class="lbl_text">EXTERNAL ATTENDEES</b>
                                        <div class="input-group add-attendance-section" style="padding-top: 7px;">
                                            <button onclick="clickAdditionalPartisipantManualOpen()" type="button" class="btn bg-blue  btn-lg waves-effect">
                                                ADD MANUAL
                                            </button>
                                        </div>
                                    </div>
                                    <div style="height: 50vh;overflow-y: scroll;background: #fff;" class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                        <table class="table table-bordered table-hover " style="border-collapse: collapse;border-spacing: 0;" id="id_list_tbl_additional_participant_manual">
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <div class="row clearfix">
                    <div class="col-xs-6 align-left">
                    </div>
                    <div class="col-xs-6 ">
                        <button type="button" class="btn btn-link waves-effect" data-dismiss="modal">CLOSE</button>

                        <button type="button" class="btn bg-red waves-effect" onclick="onSubmitAdditionalParticipants(this)">
                            Submit
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<input type="hidden" id="id_baseurl" value="@Model.ApiUrl">

@section Scripts
{
    <script>
        const ajax = {
            url : {
                get_employees : "@Model.GetEmployees",
                get_buildings : "@Model.GetBuildings",
                get_rooms : "@Model.GetRooms",
                get_available_rooms : "@Model.GetAvailableRooms",
                get_facilities : "@Model.GetFacilities",
                get_departments : "@Model.GetAlocation",
                post_create_booking : "@Model.PostCreateReserve",
                get_pantry_packages : "@Model.PantryPackages",
                get_pantry_details : "@Model.PantryPackageDetailById",
                get_bookings : "@Model.GetBookingDataTables",
                get_pic_by_bookingid : "@Model.GetPicByBookingId",
                get_check_reschedule_date : "@Model.CheckRescheduleDate",
                post_reschedule_booking : "@Model.RescheduleBooking",
                post_cancel_booking : "@Model.CancelBooking",
                post_cancel_all_booking : "@Model.CancelAllBooking",
                post_end_meeting : "@Model.EndMeeting",
                get_check_extendmeeting_time : "@Model.CheckExtendMeetingTime",
                post_set_extendmeeting : "@Model.SetExtendMeeting",
                post_confirm_attendance : "@Model.ConfirmAttendance",
                post_additional_attendees : "@Model.AdditionalAttendees",
            }
        };

        const roomCard = `@await Html.PartialAsync("Booking/Components/RoomCard")`;
    </script>
    <script src='~/assets/theme/plugins/jquery-validation/jquery.validate.js'></script>    
    <!-- TimePicker -->
    <script src="~/assets/external/jquery-timepicker/jquery.timepicker.min.js"></script>
    <!-- end TimePicker -->
    <!-- Datatables -->
    <script src="~/assets/theme/plugins/jquery-datatable/jquery.dataTables.js"></script>
    <script src="~/assets/theme/plugins/jquery-datatable/skin/bootstrap/js/dataTables.bootstrap.js"></script>
    <script src="~/assets/theme/plugins/jquery-datatable/dataTables.select.min.js"></script>
    <script src="~/assets/theme/plugins/jquery-datatable/dataTables.fixedColumns.min.js"></script>
    <!-- end Datatables -->
    <script src="~/assets/theme/plugins/sweatalert2/sweetalert2.all.min.js"></script>
    <!-- Moment Plugin Js -->
    <script src="~/assets/theme/plugins/momentjs/moment.js"></script>
    <script src="~/assets/theme/plugins/momentjs/moment-timezone.js"></script>
    <script src="~/assets/theme/plugins/momentjs/moment-timezone-data.min.js"></script>
    <script src="~/assets/external/numeral/numeral.min.js"></script>
    <script src="~/assets/external/numeral/locale.id.js"></script>
    <!--Tippy -->
    <script src="~/assets/external/popper.min.js"></script>
    <script src="~/assets/external/tippy-bundle.umd.min.js"></script>
    <!-- end Tippy -->


    <!-- Bootstrap Material Datetime Picker Plugin Js -->
    <!-- <script src="~/assets/theme/plugins/jquery-editable/src/table-edits.js"></script> -->
    <script src="~/assets/external/daterangepicker/daterangepicker.js"></script>
    <script src="~/assets/external/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
    <script src="~/assets/theme/plugins/jquery-steps/jquery.steps.js"></script>
    <script src="~/assets/process/booking/index.js" asp-append-version="true"></script>
    @* <script src="~/assets/process/booking/booking_adv.js"></script> *@
}